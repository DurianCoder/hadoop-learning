<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<configuration>
    <!--副本数配置-->
    <property>
        <name>dfs.replication</name>
        <value>2</value>
    </property>

    <!-- 集群名称，此值在接下来的配置中将多次出现务必注意同步修改-->
    <property>
        <name>dfs.nameservices</name>
        <value>mycluster</value>
    </property>

    <!-- 所有的namenode列表，此处也只是逻辑名称，非namenode所在的主机名称-->
    <property>
        <name>dfs.ha.namenodes.mycluster</name>
        <value>nn1,nn2</value>
    </property>

    <!--    # namenode之间用于RPC通信的地址，value填写namenode所在的主机地址-->
    <!--    # 默认端口8020，注意mycluster与nn1要和上文的配置一致-->
    <property>
        <name>dfs.namenode.rpc-address.mycluster.nn1</name>
        <value>centos01:8020</value>
    </property>
    <property>
        <name>dfs.namenode.rpc-address.mycluster.nn2</name>
        <value>centos02:8020</value>
    </property>

    <!--    # namenode的web访问地址，默认端口9870-->
    <property>
        <name>dfs.namenode.http-address.mycluster.nn1</name>
        <value>centos01:9870</value>
    </property>
    <property>
        <name>dfs.namenode.http-address.mycluster.nn2</name>
        <value>centos02:9870</value>
    </property>

    <!--    # journalnode主机地址，最少三台，默认端口8485-->
    <!--    # 格式为 qjournal://jn1:port;jn2:port;jn3:port/${nameservices}-->
    <property>
        <name>dfs.namenode.shared.edits.dir</name>
        <value>qjournal://centos01:8485;centos02:8485;centos03:8485/mycluster</value>
    </property>

    <!--    # 故障时自动切换的实现类，照抄即可-->
    <property>
        <name>dfs.client.failover.proxy.provider.mycluster</name>
        <value>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider</value>
    </property>

    <!--    # 故障时相互操作方式(namenode要切换active和standby)，这里我们选ssh方式-->
    <property>
        <name>dfs.ha.fencing.methods</name>
        <value>shell(/bin/true)</value>
    </property>

    <!--    # 修改为自己用户的ssh key存放地址-->
    <property>
        <name>dfs.ha.fencing.ssh.private-key-files</name>
        <value>/home/hadoop/.ssh/id_rsa</value>
    </property>

    <!--    # namenode日志文件输出路径，即journalnode读取变更的位置-->
    <property>
        <name>dfs.journalnode.edits.dir</name>
        <value>/opt/modules/hadoop-3.2.1/data/hadoop/journalnode</value>
    </property>

    <!--    # 启用自动故障转移-->
    <property>
        <name>dfs.ha.automatic-failover.enabled</name>
        <value>true</value>
    </property>
</configuration>